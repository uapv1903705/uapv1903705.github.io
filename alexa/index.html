<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>CERIWebGame</title>
		<script src="https://uapv1903705.github.io/alexa/Build/UnityLoader.js"></script>
		<script src="https://cdn.html.games.alexa.a2z.com/alexa-html/latest/alexa-html.js"></script>
	</head>
	<body style="background-color: black; color: white; padding: 0px; margin: 0px">
		<div name="outputDiv" style="margin: auto; width: 90%; text-align:center; font-size: 32px; padding: 8px; margin-top: 20px">

			<p style="font-size: 24px"><span id="alexaStatus">Attente du code JS d'Alexa...</span></p>
			<p name="outputTxt"><b>Sortie textuelle</b></p>

		</div>
		<p>14/04/2021 15:11</p>
		<p name="test_alexa">J'attend ton message Alexa.</p>
		<div class="webgl-content" style="width: 90%; height: 70%; margin: auto;">
			<p>Viewport:</p>
			<div id="unityContainer"></div>
		</div>
	</body>


	<script>
	var alexaClient;
	try
	{
		//var alexaClient;
		Alexa.create({version: '1.1'}).then((args) =>
		{
			const{alexa,message} = args;

			alexaClient = alexa;
			document.getElementById('alexaStatus').innerHTML = 'Alexa is ready :)';
		})
		.catch(error =>
		{
			document.getElementById('alexaStatus').innerHTML = error;//'Alexa not ready :(';
		});
	}
	catch (error)
	{
		document.getElementById('alexaStatus').innerHTML = error;
	}

	alexaClient.skill.onMessage(messageReceivedCallback);

	const messageReceivedCallback = function(message){
			document.getElementsByName('test_alexa').innerHTML='Message re√ßu 5/5!';
	};

	</script>

	<script>
		// Instanciation du jeu Unity
		var unityInstance = UnityLoader.instantiate("unityContainer", "Build/Build.json");
		let outputDiv = document.getElementsByName("outputDiv")[0];
		let outputTxt = document.getElementsByName("outputTxt")[0];

		function color(r,g,b)
		{
			r *= 255; g *= 255; b *= 255;
			outputDiv.style.backgroundColor = "rgb("+r+","+g+","+b+")";
		}
		function sendInputText()
		{
			unityInstance.SendMessage("BrowserTest", "setText", outputTxt.innerHTML);
		}

	</script>

</html>
